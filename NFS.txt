Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2018-03-07T15:41:21+10:00

https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/configuring-automount

**DEBUGGING NFS + KRB**
[[/etc/nfs.conf]]
[gssd]
use-gss-proxy=1
Verbosity=3 

Restart rpc.gssd & gssproxy services and collect:
/var/log/messages

**ID MAPPING**
https://access.redhat.com/articles/2252881

**NFS KERBEROS ROOT ACCESS**
https://access.redhat.com/articles/4040141
https://bugzilla.redhat.com/show_bug.cgi?id=1559185

**GSSAPI**
Both services below are required to run kerberized NFS mounts
**RPC-GSSD** (Manual access of TGT or Keytab ie: mount command)
This is the kernel daemon that is used to access principals [[/etc/krb5.keytab]] or user tgt [[/tmp/krb5_cc]]
**GSSPROXY **
API used to interface from users and/or applications to RPC-GSSD 
https://pagure.io/gssproxy/blob/master/f/docs

**SETUP KRB NFS SERVER RHEL7**
https://access.redhat.com/solutions/1365423

**KRB NFS and AD**
https://access.redhat.com/solutions/2677831

**GSSPROXY +** **NFS + KRB (APP USER) **
https://access.redhat.com/solutions/2204041

**PAM**
# yum install -y oddjob_mkhomedir
# authconfig --enablemkhomedir --update

**NFS AND AUTOMOUNT**
SETUP AUTOMOUNT(MAPS) IN IPA SERVER
# Follow server setup as per KB above

**SETTING UP NFS SERVER TO BE KRB-AWARE**
# ipa service-add nfs/nfs-server.example.com
# ipa service-show nfs/nfs-server.example.com
# ipa-getkeytab -s ipaserver.example.com -p nfs/nfs-server.example.com -k [[/etc/krb5.keytab]]

**SETTING UP IPA CLIENT** 
# ipa-client-automount --uninstall
# ipa-client-automount --server=ipa.example.com --location=ipauserhome
# authconfig --update --enablesssd --enablesssdauth --enablemkhomedir

**DEBUGGING**
https://access.redhat.com/articles/1153563
# vi /etc/sysconfig/nfs
	RPCIDMAPDARGS="-vvv"
	RPCSVCGSSDARGS="-vvv"
	RPCGSSDARGS="-vvv"
	RPCMOUNTDOPTS="-d all"

**IDMAPD**
https://access.redhat.com/solutions/1232273
**GSSPROXY**
# vim /etc/gssproxy/gssproxy.conf
  [gssproxy]
 debug = true
 debug_level = 2
 # systemctl restart gssproxy.service
