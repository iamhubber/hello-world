Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2018-02-19T15:57:23+10:00

**DNSUPDATE WITH TSIG**
https://www.freeipa.org/page/Howto/DNS_updates_and_zone_transfers_with_TSIG

**DNS RESOLUTION OPTIONS**
dns_resolver_op_timeout - timeout for single dns query
dns_resolver_timeout - timeout for service resolution (it may include multiple dns queries)
ldap_opt_timeout - timeout for an LDAP query which may trigger dns resolution depending on current failover status

Correct Order:
dns_resolver_op_timeout < dns_resolver_timeout < ldap_opt_timeout

**VERIFY DNS RESOLUTION**
# dig +short -x ip.add.re.ss
# dig @localhost +short cnn.com

**DISABLE UPDATE RESOLV.CONF NETWORK MANAGER**
# cat [[/etc/sysconfig/network-scripts/ifcfg-eth0]]
peerdns = "no"
dns1 = "IPADDRESS OF DNS SERVER"
# systemctl restart NetworkManager
# nmcli con up eth0

**DNS ROUND ROBIN (client)**
nameserver 192.168.0.1
nameserver 192.168.0.2
options timeout:1 attempts:1 rotate

**RUN NSUPDATE MANUALLY**
1. Make a file /tmp/nsupdate.txt with following content:
---
update delete enxta050-app09.tst.enexis.it. in A
update add enxta050-app09.tst.enexis.it. 300 in A 10.119.128.252
send
update delete enxta050-app09.tst.enexis.it. in AAAA
send
---
2. Then kinit as below:
---
# kinit -k 'ENXTA050-APP09$'
# klist
---
3. Then run nsupdate as below:
---
# nsupdate -g -dD -L 255 < /tmp/nsupdate.txt
---

**TROUBLESHOOTING**
Tcpdump
# tcpdump -nn -vvv -i any -w dns-ad.cap host <DNS-ip> 
# kinit and/or nsupdate
Log
	[[/var/named/data/named.run]]
Man
	named.conf
Debug
	logging {
		channel default_debug {
		file "data/named.run";
		severity dynamic;
							};
			};
